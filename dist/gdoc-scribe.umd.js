(function(d,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],o):(d=typeof globalThis<"u"?globalThis:d||self,o(d.GDocScribe={},d.React))})(this,function(d,o){"use strict";var Q=Object.defineProperty;var V=(d,o,f)=>o in d?Q(d,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):d[o]=f;var w=(d,o,f)=>V(d,typeof o!="symbol"?o+"":o,f);const f=n=>n.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""),E=n=>n.map(t=>{var e;return((e=t.textRun)==null?void 0:e.content)||""}).join("").replace(/\u000b/g,"").trim(),b=n=>{const t=[];let e=null,r=null;if(!n)return[];for(let l=0;l<n.length;l++){const a=n[l],i=a.paragraph?E(a.paragraph.elements||[]):"";if(!r&&i.trim().startsWith("```")){const u=i.trim(),s=u.match(/^```(\w*)\s*([\s\S]*?)\s*```$/);if(s&&u.length>3){t.push({type:"code_block",language:s[1]||"",content:s[2]});continue}r={type:"code_block",language:i.trim().replace(/^```/,"").trim(),content:[]};continue}if(r&&i.trim()==="```"){t.push({type:"code_block",language:r.language,content:r.content.join(`
`)}),r=null;continue}if(r){r.content.push(i);continue}if(a.paragraph&&a.paragraph.bullet){const u=a.paragraph.bullet.listId;!e||e.listId!==u?(e={type:"list_group",listId:u||"",items:[a]},t.push(e)):e.items.push(a)}else e=null,t.push(a)}return r&&t.push({type:"code_block",language:r.language,content:r.content.join(`
`)}),t},S=n=>{const t=[],e=[];return n.forEach(r=>{var i,u;const l=((u=(i=r.paragraph)==null?void 0:i.bullet)==null?void 0:u.nestingLevel)||0,a={item:r,children:[],level:l};for(;e.length>0&&e[e.length-1].level>=l;)e.pop();e.length===0?t.push(a):e[e.length-1].children.push(a),e.push(a)}),t},N=n=>{const t=[];return n.forEach(e=>{var r,l;if(e.paragraph&&((l=(r=e.paragraph.paragraphStyle)==null?void 0:r.namedStyleType)!=null&&l.startsWith("HEADING"))){const a=e.paragraph.paragraphStyle.namedStyleType,i=parseInt(a.split("_")[1]),u=E(e.paragraph.elements||[]);u&&!isNaN(i)&&t.push({id:f(u),text:u,level:i})}}),t},T=n=>n.split(/(`[^`]+`)/g).map(e=>e.startsWith("`")&&e.endsWith("`")&&e.length>2?{type:"code",content:e.slice(1,-1)}:{type:"text",content:e}).filter(e=>e.content!==""),I=n=>{var e;if(!n)return[];const t=[];return n.bold&&t.push({tag:"strong"}),n.italic&&t.push({tag:"em"}),n.underline&&t.push({tag:"u"}),n.strikethrough&&t.push({tag:"s"}),(e=n.link)!=null&&e.url&&t.push({tag:"a",attrs:{href:n.link.url,target:"_blank",rel:"noopener noreferrer"}}),t},L=n=>{const t=n==null?void 0:n.namedStyleType;if(t==="TITLE")return"h1";if(t==="SUBTITLE")return"p";if(t!=null&&t.startsWith("HEADING_")){const e=t.split("_")[1];if(["1","2","3","4","5","6"].includes(e))return`h${e}`}return"p"},x=(n,t,e)=>{var g,p;if(!n||!e)return{tag:"ul",styleType:"disc"};const r=e[n];if(!r)return{tag:"ul",styleType:"disc"};const l=t||0,a=(p=(g=r.listProperties)==null?void 0:g.nestingLevels)==null?void 0:p[l];let i=a==null?void 0:a.glyphType;if(!i||i==="GLYPH_TYPE_UNSPECIFIED")if(a!=null&&a.glyphSymbol){const c=a.glyphSymbol;c==="●"?i="DISC":c==="○"?i="CIRCLE":c==="■"?i="SQUARE":i="DISC"}else a!=null&&a.glyphFormat&&a.glyphFormat.includes("%")?i="DECIMAL":i="DISC";const s={DECIMAL:{tag:"ol",style:"decimal"},DECIMAL_ZERO:{tag:"ol",style:"decimal-leading-zero"},UPPER_ALPHA:{tag:"ol",style:"upper-alpha"},ALPHA:{tag:"ol",style:"lower-alpha"},UPPER_ROMAN:{tag:"ol",style:"upper-roman"},ROMAN:{tag:"ol",style:"lower-roman"},DISC:{tag:"ul",style:"disc"},CIRCLE:{tag:"ul",style:"circle"},SQUARE:{tag:"ul",style:"square"},NONE:{tag:"ul",style:"none"}}[i]||{tag:"ul",style:"disc"};return{tag:s.tag,styleType:s.style}},v=n=>{switch(n){case"CENTER":return"center";case"END":return"right";case"JUSTIFIED":return"justify";default:return}},D=(n,t)=>{var r,l,a;if(!n||!t)return null;const e=(l=(r=t[n])==null?void 0:r.inlineObjectProperties)==null?void 0:l.embeddedObject;return(a=e==null?void 0:e.imageProperties)!=null&&a.contentUri?{src:e.imageProperties.contentUri,alt:"Embedded Image"}:null},m=n=>n!=null&&n.magnitude&&(n!=null&&n.unit)?`${n.magnitude}${n.unit.toLowerCase()}`:null,k=n=>{if(n!=null&&n.rgbColor){const{red:t,green:e,blue:r}=n.rgbColor,l=Math.round((t||0)*255),a=Math.round((e||0)*255),i=Math.round((r||0)*255);return`rgb(${l}, ${a}, ${i})`}return null};class M{constructor(t){w(this,"doc");w(this,"inlineObjects");this.doc=t,this.inlineObjects=t.inlineObjects||null}render(t){var r;if(t.innerHTML="",!((r=this.doc.body)!=null&&r.content))return;b(this.doc.body.content).forEach(l=>{if("type"in l&&l.type==="list_group")t.appendChild(this.renderListGroup(l.items));else if("type"in l&&l.type==="code_block")t.appendChild(this.renderCodeBlock(l));else{const a=l;a.paragraph?t.appendChild(this.renderParagraph(a.paragraph)):a.table&&t.appendChild(this.renderTable(a.table))}})}renderCodeBlock(t){const e=document.createElement("pre"),r=document.createElement("code");return t.language&&(r.className=`language-${t.language}`),r.textContent=t.content,e.appendChild(r),e}renderParagraph(t){var i,u;const e=t.paragraphStyle,r=L(e),l=document.createElement(r),a=v((e==null?void 0:e.alignment)||void 0);if(a&&(l.style.textAlign=a),e!=null&&e.indentStart){const s=m(e.indentStart);s&&(l.style.paddingLeft=s)}if(e!=null&&e.indentEnd){const s=m(e.indentEnd);s&&(l.style.paddingRight=s)}if(e!=null&&e.indentFirstLine){const s=m(e.indentFirstLine);s&&(l.style.textIndent=s)}if(e!=null&&e.spaceAbove){const s=m(e.spaceAbove);s&&(l.style.marginTop=s)}if(e!=null&&e.spaceBelow){const s=m(e.spaceBelow);s&&(l.style.marginBottom=s)}if((u=(i=e==null?void 0:e.shading)==null?void 0:i.backgroundColor)!=null&&u.color){const s=k(e.shading.backgroundColor.color);s&&(l.style.backgroundColor=s,l.style.padding="10px",l.style.borderRadius="4px")}if(r.startsWith("h")){const s=E(t.elements||[]);s&&(l.id=f(s))}return t.elements&&t.elements.forEach(s=>{if(s.textRun){const g=this.renderTextRun(s.textRun);l.appendChild(g)}else if(s.inlineObjectElement){const g=this.renderImage(s.inlineObjectElement.inlineObjectId);g&&l.appendChild(g)}}),l}renderTextRun(t){let e=t.content||"";if(!e)return document.createTextNode("");e=e.replace(/\u000b/g,"");const r=I(t.textStyle),l=u=>{if(r.length===0)return document.createTextNode(u);let s=null,g=null;for(const p of r){const c=document.createElement(p.tag);p.attrs&&Object.entries(p.attrs).forEach(([h,y])=>c.setAttribute(h,y)),s?(g.appendChild(c),g=c):(s=c,g=c)}return g&&(g.textContent=u),s},a=T(e);if(a.length===1&&a[0].type==="text")return l(a[0].content);const i=document.createDocumentFragment();return a.forEach(u=>{if(u.type==="code"){const s=document.createElement("code");if(s.textContent=u.content,r.length===0)i.appendChild(s);else{let g=null,p=null;for(const c of r){const h=document.createElement(c.tag);c.attrs&&Object.entries(c.attrs).forEach(([y,C])=>h.setAttribute(y,C)),g?(p.appendChild(h),p=h):(g=h,p=h)}p?(p.appendChild(s),i.appendChild(g)):i.appendChild(s)}}else i.appendChild(l(u.content))}),i}renderListGroup(t){const e=S(t);return this.renderListTree(e)}renderListTree(t){var s,g;if(t.length===0)return document.createElement("ul");const e=t[0],r=(g=(s=e.item.paragraph)==null?void 0:s.bullet)==null?void 0:g.listId,l=e.level,{tag:a,styleType:i}=x(r,l,this.doc.lists),u=document.createElement(a);return u.style.listStyleType=i,t.forEach(p=>{var h;const c=document.createElement("li");(h=p.item.paragraph)!=null&&h.elements&&p.item.paragraph.elements.forEach(y=>{y.textRun&&c.appendChild(this.renderTextRun(y.textRun))}),p.children.length>0&&c.appendChild(this.renderListTree(p.children)),u.appendChild(c)}),u}renderTable(t){const e=document.createElement("table"),r=document.createElement("tbody");return e.appendChild(r),(t.tableRows||[]).forEach(l=>{const a=document.createElement("tr");(l.tableCells||[]).forEach(i=>{var s,g;const u=document.createElement("td");(s=i.tableCellStyle)!=null&&s.columnSpan&&(u.colSpan=i.tableCellStyle.columnSpan),(g=i.tableCellStyle)!=null&&g.rowSpan&&(u.rowSpan=i.tableCellStyle.rowSpan),i.content&&b(i.content).forEach(c=>{if("type"in c&&c.type==="list_group")u.appendChild(this.renderListGroup(c.items));else{const h=c;h.paragraph&&u.appendChild(this.renderParagraph(h.paragraph))}}),a.appendChild(u)}),r.appendChild(a)}),e}renderImage(t){const e=D(t,this.inlineObjects);if(!e)return null;const r=document.createElement("img");return r.src=e.src,r.alt=e.alt,r.style.cursor="pointer",r.onclick=()=>this.openLightbox(r.src),r}openLightbox(t){const e=document.createElement("div");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(0,0,0,0.8)",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.zIndex="9999",e.style.cursor="pointer";const r=document.createElement("img");r.src=t,r.style.maxWidth="90%",r.style.maxHeight="90%",r.style.objectFit="contain",e.appendChild(r),e.onclick=()=>document.body.removeChild(e),document.body.appendChild(e)}}const A=n=>{const t=o.useMemo(()=>{var r;return(r=n==null?void 0:n.body)!=null&&r.content?N(n.body.content):[]},[n]);return{html:o.useMemo(()=>{var r;return(r=n==null?void 0:n.body)!=null&&r.content?j(n.body.content,n.inlineObjects,n.lists):null},[n]),toc:t}};function j(n,t,e){return b(n).map((l,a)=>{if("type"in l&&l.type==="list_group")return o.createElement(H,{key:a,items:l.items,inlineObjects:t,lists:e});if("type"in l&&l.type==="code_block")return o.createElement(P,{key:a,block:l});const i=l;return i.paragraph?o.createElement(B,{key:a,paragraph:i.paragraph,inlineObjects:t}):i.table?o.createElement($,{key:a,table:i.table,inlineObjects:t,lists:e}):null})}function P({block:n}){return o.createElement("pre",null,o.createElement("code",{className:n.language?`language-${n.language}`:void 0},n.content))}function B({paragraph:n,inlineObjects:t}){var s,g,p;const e=n.paragraphStyle,r=L(e),l=r,a=v((e==null?void 0:e.alignment)||void 0),i={};if(a&&(i.textAlign=a),e!=null&&e.indentStart){const c=m(e.indentStart);c&&(i.paddingLeft=c)}if(e!=null&&e.indentEnd){const c=m(e.indentEnd);c&&(i.paddingRight=c)}if(e!=null&&e.indentFirstLine){const c=m(e.indentFirstLine);c&&(i.textIndent=c)}if(e!=null&&e.spaceAbove){const c=m(e.spaceAbove);c&&(i.marginTop=c)}if(e!=null&&e.spaceBelow){const c=m(e.spaceBelow);c&&(i.marginBottom=c)}if((g=(s=e==null?void 0:e.shading)==null?void 0:s.backgroundColor)!=null&&g.color){const c=k(e.shading.backgroundColor.color);c&&(i.backgroundColor=c,i.padding="10px",i.borderRadius="4px")}let u;if(r.startsWith("h")){const c=E(n.elements||[]);c&&(u=f(c))}return o.createElement(l,{id:u,style:i},(p=n.elements)==null?void 0:p.map((c,h)=>o.createElement(o.Fragment,{key:h},c.textRun&&o.createElement(_,{textRun:c.textRun}),c.inlineObjectElement&&o.createElement(W,{objectId:c.inlineObjectElement.inlineObjectId,inlineObjects:t}))))}function _({textRun:n}){let t=n.content||"";if(!t)return null;t=t.replace(/\u000b/g,"");const e=I(n.textStyle),r=(a,i)=>{if(i.length===0)return a;const[u,...s]=i,g=u.tag;return o.createElement(g,{...u.attrs||{}},r(a,s))},l=T(t);return o.createElement(o.Fragment,null,l.map((a,i)=>a.type==="code"?o.createElement(o.Fragment,{key:i},r(a.content,[{tag:"code"},...e])):o.createElement(o.Fragment,{key:i},r(a.content,e))))}function H({items:n,inlineObjects:t,lists:e}){const r=S(n);return o.createElement(F,{nodes:r,inlineObjects:t,lists:e})}function F({nodes:n,inlineObjects:t,lists:e}){var p,c;if(n.length===0)return null;const r=n[0],l=(c=(p=r.item.paragraph)==null?void 0:p.bullet)==null?void 0:c.listId,a=r.level,{tag:i,styleType:u}=x(l,a,e),s=i,g={listStyleType:u};return o.createElement(s,{style:g},n.map((h,y)=>{var C,O;return o.createElement("li",{key:y},(O=(C=h.item.paragraph)==null?void 0:C.elements)==null?void 0:O.map((G,q)=>o.createElement(o.Fragment,{key:q},G.textRun&&o.createElement(_,{textRun:G.textRun}))),h.children.length>0&&o.createElement(F,{nodes:h.children,inlineObjects:t,lists:e}))}))}function $({table:n,inlineObjects:t,lists:e}){var r;return o.createElement("table",null,o.createElement("tbody",null,(r=n.tableRows)==null?void 0:r.map((l,a)=>{var i;return o.createElement("tr",{key:a},(i=l.tableCells)==null?void 0:i.map((u,s)=>{var g,p;return o.createElement("td",{key:s,colSpan:((g=u.tableCellStyle)==null?void 0:g.columnSpan)||1,rowSpan:((p=u.tableCellStyle)==null?void 0:p.rowSpan)||1},u.content&&j(u.content,t,e))}))})))}function W({objectId:n,inlineObjects:t}){const[e,r]=o.useState(!1),l=D(n,t);return l?o.createElement(o.Fragment,null,o.createElement("img",{src:l.src,alt:l.alt,onClick:()=>r(!0),style:{cursor:"pointer"}}),e&&o.createElement("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,cursor:"pointer"},onClick:()=>r(!1)},o.createElement("img",{src:l.src,style:{maxWidth:"90%",maxHeight:"90%",objectFit:"contain"}}))):null}const U=({doc:n,className:t})=>{const{html:e,toc:r}=A(n);return n?o.createElement("div",{className:t},o.createElement("div",{className:"gdoc-content"},e),r.length>0&&o.createElement("nav",{className:"gdoc-toc"},o.createElement("ul",null,r.map(l=>o.createElement("li",{key:l.id,className:`gdoc-toc-level-${l.level}`},o.createElement("a",{href:`#${l.id}`},l.text)))))):null},z=({doc:n,className:t})=>{const{html:e}=A(n);return n?o.createElement("div",{className:t},e):null};d.GDocContent=z,d.GDocScribe=M,d.GDocViewer=U,d.buildListTree=S,d.extractHeadings=N,d.getAlignmentStyle=v,d.getColorStyle=k,d.getDimensionStyle=m,d.getHeadingTag=L,d.getImageData=D,d.getListTagAndStyle=x,d.getParagraphText=E,d.getTextTags=I,d.parseInlineContent=T,d.processContent=b,d.slugify=f,d.useDocs=A,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
