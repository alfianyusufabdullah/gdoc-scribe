(function(f,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],c):(f=typeof globalThis<"u"?globalThis:f||self,c(f.GDocScribeLib={},f.React))})(this,function(f,c){"use strict";var X=Object.defineProperty;var N=(f,c,C)=>c in f?X(f,c,{enumerable:!0,configurable:!0,writable:!0,value:C}):f[c]=C;var x=(f,c,C)=>N(f,typeof c!="symbol"?c+"":c,C);const C=o=>o.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""),L=o=>o.map(r=>{var n;return((n=r.textRun)==null?void 0:n.content)||""}).join("").replace(/\u000b/g,"").trim(),v=(o,r=[])=>{const n=[];let t=null,e=null;if(!o)return[];for(let i=0;i<o.length;i++){const s=o[i],d=s.paragraph?L(s.paragraph.elements||[]):"";if(!e&&d.trim().startsWith("```")){const p=d.trim(),l=p.match(/^```(\w*)\s*([\s\S]*?)\s*```$/);if(l&&p.length>3){n.push({type:"code_block",language:l[1]||"",content:l[2]});continue}e={type:"code_block",language:d.trim().replace(/^```/,"").trim(),content:[]};continue}if(e&&d.trim()==="```"){n.push({type:"code_block",language:e.language,content:e.content.join(`
`)}),e=null;continue}if(e){e.content.push(d);continue}if(s.paragraph&&s.paragraph.bullet){const p=s.paragraph.bullet.listId;!t||t.listId!==p?(t={type:"list_group",listId:p||"",items:[s]},n.push(t)):t.items.push(s)}else t=null,n.push(s)}return e&&n.push({type:"code_block",language:e.language,content:e.content.join(`
`)}),r.reduce((i,s)=>s(i),n)},D=o=>{const r=[],n=[];return o.forEach(t=>{var s,d;const e=((d=(s=t.paragraph)==null?void 0:s.bullet)==null?void 0:d.nestingLevel)||0,i={item:t,children:[],level:e};for(;n.length>0&&n[n.length-1].level>=e;)n.pop();n.length===0?r.push(i):n[n.length-1].children.push(i),n.push(i)}),r},k=o=>{const r=[];return o.forEach(n=>{var t,e;if(n.paragraph&&((e=(t=n.paragraph.paragraphStyle)==null?void 0:t.namedStyleType)!=null&&e.startsWith("HEADING"))){const i=n.paragraph.paragraphStyle.namedStyleType,s=parseInt(i.split("_")[1]),d=L(n.paragraph.elements||[]);d&&!isNaN(s)&&r.push({id:C(d),text:d,level:s})}}),r},w=o=>o.split(/(`[^`]+`)/g).map(n=>n.startsWith("`")&&n.endsWith("`")&&n.length>2?{type:"code",content:n.slice(1,-1)}:{type:"text",content:n}).filter(n=>n.content!==""),A=o=>{var n;if(!o)return[];const r=[];return o.bold&&r.push({tag:"strong"}),o.italic&&r.push({tag:"em"}),o.underline&&r.push({tag:"u"}),o.strikethrough&&r.push({tag:"s"}),(n=o.link)!=null&&n.url&&r.push({tag:"a",attrs:{href:o.link.url,target:"_blank",rel:"noopener noreferrer"}}),r},j=o=>{const r=o==null?void 0:o.namedStyleType;if(r==="TITLE")return"h1";if(r==="SUBTITLE")return"p";if(r!=null&&r.startsWith("HEADING_")){const n=r.split("_")[1];if(["1","2","3","4","5","6"].includes(n))return`h${n}`}return"p"},O=(o,r,n)=>{var l,a;if(!o||!n)return{tag:"ul",styleType:"disc"};const t=n[o];if(!t)return{tag:"ul",styleType:"disc"};const e=r||0,i=(a=(l=t.listProperties)==null?void 0:l.nestingLevels)==null?void 0:a[e];let s=i==null?void 0:i.glyphType;if(!s||s==="GLYPH_TYPE_UNSPECIFIED")if(i!=null&&i.glyphSymbol){const h=i.glyphSymbol;h==="●"?s="DISC":h==="○"?s="CIRCLE":h==="■"?s="SQUARE":s="DISC"}else i!=null&&i.glyphFormat&&i.glyphFormat.includes("%")?s="DECIMAL":s="DISC";const p={DECIMAL:{tag:"ol",style:"decimal"},DECIMAL_ZERO:{tag:"ol",style:"decimal-leading-zero"},UPPER_ALPHA:{tag:"ol",style:"upper-alpha"},ALPHA:{tag:"ol",style:"lower-alpha"},UPPER_ROMAN:{tag:"ol",style:"upper-roman"},ROMAN:{tag:"ol",style:"lower-roman"},DISC:{tag:"ul",style:"disc"},CIRCLE:{tag:"ul",style:"circle"},SQUARE:{tag:"ul",style:"square"},NONE:{tag:"ul",style:"none"}}[s]||{tag:"ul",style:"disc"};return{tag:p.tag,styleType:p.style}},B=o=>{switch(o){case"CENTER":return"center";case"END":return"right";case"JUSTIFIED":return"justify";default:return}},F=(o,r)=>{var t,e,i;if(!o||!r)return null;const n=(e=(t=r[o])==null?void 0:t.inlineObjectProperties)==null?void 0:e.embeddedObject;return(i=n==null?void 0:n.imageProperties)!=null&&i.contentUri?{src:n.imageProperties.contentUri,alt:"Embedded Image"}:null},y=o=>o!=null&&o.magnitude&&(o!=null&&o.unit)?`${o.magnitude}${o.unit.toLowerCase()}`:null,G=o=>{if(o!=null&&o.rgbColor){const{red:r,green:n,blue:t}=o.rgbColor,e=Math.round((r||0)*255),i=Math.round((n||0)*255),s=Math.round((t||0)*255);return`rgb(${e}, ${i}, ${s})`}return null};class U{constructor(r,n={}){x(this,"doc");x(this,"inlineObjects");x(this,"options");this.doc=r,this.inlineObjects=r.inlineObjects||null,this.options=n}getToc(){var r;return(r=this.doc.body)!=null&&r.content?k(this.doc.body.content):[]}render(r){var t;if(r.innerHTML="",!((t=this.doc.body)!=null&&t.content))return;v(this.doc.body.content,this.options.transformers).forEach(e=>{var i,s,d,p;try{if("type"in e&&e.type==="list_group"){const l=((i=this.options.renderers)==null?void 0:i.list_group)||this.renderListGroup.bind(this);r.appendChild(l(e.items,this.inlineObjects,this.doc.lists))}else if("type"in e&&e.type==="code_block"){const l=((s=this.options.renderers)==null?void 0:s.code_block)||this.renderCodeBlock.bind(this);r.appendChild(l(e))}else{const l=e;if(l.paragraph){const a=((d=this.options.renderers)==null?void 0:d.paragraph)||this.renderParagraph.bind(this);r.appendChild(a(l.paragraph,this.inlineObjects))}else if(l.table){const a=((p=this.options.renderers)==null?void 0:p.table)||this.renderTable.bind(this);r.appendChild(a(l.table,this.inlineObjects,this.doc.lists))}}}catch(l){console.error("Error rendering block:",l);const a=document.createElement("div");a.style.color="red",a.style.border="1px dashed red",a.style.padding="8px",a.textContent="Error rendering block",r.appendChild(a)}})}renderCodeBlock(r){var e;const n=document.createElement("pre");(e=this.options.classNames)!=null&&e.code_block&&(n.className=this.options.classNames.code_block);const t=document.createElement("code");return r.language&&(t.className=`language-${r.language}`),t.textContent=r.content,n.appendChild(t),n}renderParagraph(r,n){var d,p;const t=r.paragraphStyle,e=j(t),i=document.createElement(e);this.options.classNames&&(this.options.classNames.paragraph&&i.classList.add(this.options.classNames.paragraph),e==="h1"&&this.options.classNames.h1&&i.classList.add(this.options.classNames.h1),e==="h2"&&this.options.classNames.h2&&i.classList.add(this.options.classNames.h2),e==="h3"&&this.options.classNames.h3&&i.classList.add(this.options.classNames.h3),e==="h4"&&this.options.classNames.h4&&i.classList.add(this.options.classNames.h4),e==="h5"&&this.options.classNames.h5&&i.classList.add(this.options.classNames.h5),e==="h6"&&this.options.classNames.h6&&i.classList.add(this.options.classNames.h6));const s=B((t==null?void 0:t.alignment)||void 0);if(s&&(i.style.textAlign=s),t!=null&&t.indentStart){const l=y(t.indentStart);l&&(i.style.paddingLeft=l)}if(t!=null&&t.indentEnd){const l=y(t.indentEnd);l&&(i.style.paddingRight=l)}if(t!=null&&t.indentFirstLine){const l=y(t.indentFirstLine);l&&(i.style.textIndent=l)}if(t!=null&&t.spaceAbove){const l=y(t.spaceAbove);l&&(i.style.marginTop=l)}if(t!=null&&t.spaceBelow){const l=y(t.spaceBelow);l&&(i.style.marginBottom=l)}if((p=(d=t==null?void 0:t.shading)==null?void 0:d.backgroundColor)!=null&&p.color){const l=G(t.shading.backgroundColor.color);l&&(i.style.backgroundColor=l,i.style.padding="10px",i.style.borderRadius="4px")}if(e.startsWith("h")){const l=L(r.elements||[]);l&&(i.id=C(l))}return r.elements&&r.elements.forEach(l=>{var a;if(l.textRun){const h=this.renderTextRun(l.textRun);i.appendChild(h)}else if(l.inlineObjectElement){const g=(((a=this.options.renderers)==null?void 0:a.image)||this.renderImage.bind(this))(l.inlineObjectElement.inlineObjectId,n);g&&i.appendChild(g)}}),i}renderTextRun(r){let n=r.content||"";if(!n)return document.createTextNode("");n=n.replace(/\u000b/g,"");const t=A(r.textStyle),e=d=>{if(t.length===0)return document.createTextNode(d);let p=null,l=null;for(const a of t){const h=document.createElement(a.tag);a.attrs&&Object.entries(a.attrs).forEach(([g,m])=>h.setAttribute(g,m)),p?(l.appendChild(h),l=h):(p=h,l=h)}return l&&(l.textContent=d),p},i=w(n);if(i.length===1&&i[0].type==="text")return e(i[0].content);const s=document.createDocumentFragment();return i.forEach(d=>{if(d.type==="code"){const p=document.createElement("code");if(p.textContent=d.content,t.length===0)s.appendChild(p);else{let l=null,a=null;for(const h of t){const g=document.createElement(h.tag);h.attrs&&Object.entries(h.attrs).forEach(([m,u])=>g.setAttribute(m,u)),l?(a.appendChild(g),a=g):(l=g,a=g)}a?(a.appendChild(p),s.appendChild(l)):s.appendChild(p)}}else s.appendChild(e(d.content))}),s}renderListGroup(r,n,t){const e=D(r);return this.renderListTree(e,n,t)}renderListTree(r,n,t){var a,h,g;if(r.length===0)return document.createElement("ul");const e=r[0],i=(h=(a=e.item.paragraph)==null?void 0:a.bullet)==null?void 0:h.listId,s=e.level,{tag:d,styleType:p}=O(i,s,t||this.doc.lists),l=document.createElement(d);return l.style.listStyleType=p,(g=this.options.classNames)!=null&&g.list_group&&(l.className=this.options.classNames.list_group),r.forEach(m=>{var S,b;const u=document.createElement("li");(S=this.options.classNames)!=null&&S.list_item&&(u.className=this.options.classNames.list_item),(b=m.item.paragraph)!=null&&b.elements&&m.item.paragraph.elements.forEach(T=>{T.textRun&&u.appendChild(this.renderTextRun(T.textRun))}),m.children.length>0&&u.appendChild(this.renderListTree(m.children,n,t)),l.appendChild(u)}),l}renderTable(r,n,t){var s;const e=document.createElement("table");(s=this.options.classNames)!=null&&s.table&&(e.className=this.options.classNames.table);const i=document.createElement("tbody");return e.appendChild(i),(r.tableRows||[]).forEach(d=>{var l;const p=document.createElement("tr");(l=this.options.classNames)!=null&&l.table_row&&(p.className=this.options.classNames.table_row),(d.tableCells||[]).forEach(a=>{var g,m,u;const h=document.createElement("td");(g=this.options.classNames)!=null&&g.table_cell&&(h.className=this.options.classNames.table_cell),(m=a.tableCellStyle)!=null&&m.columnSpan&&(h.colSpan=a.tableCellStyle.columnSpan),(u=a.tableCellStyle)!=null&&u.rowSpan&&(h.rowSpan=a.tableCellStyle.rowSpan),a.content&&v(a.content,this.options.transformers).forEach(b=>{var T,I,_;if("type"in b&&b.type==="list_group"){const E=((T=this.options.renderers)==null?void 0:T.list_group)||this.renderListGroup.bind(this);h.appendChild(E(b.items,n,t))}else if("type"in b&&b.type==="code_block"){const E=((I=this.options.renderers)==null?void 0:I.code_block)||this.renderCodeBlock.bind(this);h.appendChild(E(b))}else{const E=b;if(E.paragraph){const P=((_=this.options.renderers)==null?void 0:_.paragraph)||this.renderParagraph.bind(this);h.appendChild(P(E.paragraph,n))}}}),p.appendChild(h)}),i.appendChild(p)}),e}renderImage(r,n){var i;const t=F(r,n);if(!t)return null;const e=document.createElement("img");return e.src=t.src,e.alt=t.alt,(i=this.options.classNames)!=null&&i.image&&(e.className=this.options.classNames.image),e.style.cursor="pointer",e.onclick=()=>this.openLightbox(e.src),e}openLightbox(r){const n=document.createElement("div");n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.backgroundColor="rgba(0,0,0,0.8)",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.zIndex="9999",n.style.cursor="pointer";const t=document.createElement("img");t.src=r,t.style.maxWidth="90%",t.style.maxHeight="90%",t.style.objectFit="contain",n.appendChild(t),n.onclick=()=>document.body.removeChild(n),document.body.appendChild(n)}}class z extends c.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,n){console.error("GDocScribe Block Error:",r,n)}render(){return this.state.hasError?this.props.fallback||c.createElement("div",{style:{color:"red",padding:"8px",border:"1px dashed red"}},"Error rendering block"):this.props.children}}function q({block:o,classNames:r}){return c.createElement("pre",{className:r==null?void 0:r.code_block},c.createElement("code",{className:o.language?`language-${o.language}`:void 0},o.content))}function Q({paragraph:o,inlineObjects:r,renderers:n,classNames:t}){var h,g,m;const e=o.paragraphStyle,i=j(e),s=B((e==null?void 0:e.alignment)||void 0),d={};if(s&&(d.textAlign=s),e!=null&&e.indentStart){const u=y(e.indentStart);u&&(d.paddingLeft=u)}if(e!=null&&e.indentEnd){const u=y(e.indentEnd);u&&(d.paddingRight=u)}if(e!=null&&e.indentFirstLine){const u=y(e.indentFirstLine);u&&(d.textIndent=u)}if(e!=null&&e.spaceAbove){const u=y(e.spaceAbove);u&&(d.marginTop=u)}if(e!=null&&e.spaceBelow){const u=y(e.spaceBelow);u&&(d.marginBottom=u)}if((g=(h=e==null?void 0:e.shading)==null?void 0:h.backgroundColor)!=null&&g.color){const u=G(e.shading.backgroundColor.color);u&&(d.backgroundColor=u,d.padding="10px",d.borderRadius="4px")}let p;if(i.startsWith("h")){const u=L(o.elements||[]);u&&(p=C(u))}const l=(n==null?void 0:n.image)||H;let a=t==null?void 0:t.paragraph;return i==="h1"&&(a=(t==null?void 0:t.h1)||a),i==="h2"&&(a=(t==null?void 0:t.h2)||a),i==="h3"&&(a=(t==null?void 0:t.h3)||a),i==="h4"&&(a=(t==null?void 0:t.h4)||a),i==="h5"&&(a=(t==null?void 0:t.h5)||a),i==="h6"&&(a=(t==null?void 0:t.h6)||a),c.createElement(i,{id:p,style:d,className:a},(m=o.elements)==null?void 0:m.map((u,S)=>c.createElement(c.Fragment,{key:S},u.textRun&&c.createElement($,{textRun:u.textRun}),u.inlineObjectElement&&c.createElement(l,{objectId:u.inlineObjectElement.inlineObjectId,inlineObjects:r,classNames:t}))))}function $({textRun:o}){if(!o.content)return null;const r=o.content.replace(/\u000b/g,""),n=A(o.textStyle),t=i=>n.length===0?c.createElement(c.Fragment,null,i):n.reduceRight((s,d)=>{const p=d.tag;return c.createElement(p,{...d.attrs},s)},c.createElement(c.Fragment,null,i)),e=w(r);return c.createElement(c.Fragment,null,e.map((i,s)=>i.type==="code"?n.length===0?c.createElement("code",{key:s},i.content):n.reduceRight((d,p)=>{const l=p.tag;return c.createElement(l,{key:s,...p.attrs},d)},c.createElement("code",null,i.content)):c.createElement(c.Fragment,{key:s},t(i.content))))}function V({items:o,inlineObjects:r,lists:n,renderers:t,classNames:e}){const i=D(o),s=d=>{var u,S;if(d.length===0)return null;const p=d[0],l=(S=(u=p.item.paragraph)==null?void 0:u.bullet)==null?void 0:S.listId,a=p.level,{tag:h,styleType:g}=O(l,a,n),m=h;return c.createElement(m,{style:{listStyleType:g},className:e==null?void 0:e.list_group},d.map((b,T)=>{var I,_;return c.createElement("li",{key:T,className:e==null?void 0:e.list_item},(_=(I=b.item.paragraph)==null?void 0:I.elements)==null?void 0:_.map((E,P)=>{const K=(t==null?void 0:t.image)||H;return c.createElement(c.Fragment,{key:P},E.textRun&&c.createElement($,{textRun:E.textRun}),E.inlineObjectElement&&c.createElement(K,{objectId:E.inlineObjectElement.inlineObjectId,inlineObjects:r,classNames:e}))}),b.children.length>0&&s(b.children))}))};return s(i)}function Y({table:o,inlineObjects:r,lists:n,renderContent:t,classNames:e}){var i;return c.createElement("table",{className:e==null?void 0:e.table},c.createElement("tbody",null,(i=o.tableRows)==null?void 0:i.map((s,d)=>{var p;return c.createElement("tr",{key:d,className:e==null?void 0:e.table_row},(p=s.tableCells)==null?void 0:p.map((l,a)=>{var h,g,m;return(h=l.tableCellStyle)!=null&&h.columnSpan&&l.tableCellStyle.columnSpan,c.createElement("td",{key:a,colSpan:((g=l.tableCellStyle)==null?void 0:g.columnSpan)||void 0,rowSpan:((m=l.tableCellStyle)==null?void 0:m.rowSpan)||void 0,className:e==null?void 0:e.table_cell},l.content&&t(l.content,r,n))}))})))}function H({objectId:o,inlineObjects:r,classNames:n}){const t=F(o,r);return t?c.createElement("img",{src:t.src,alt:t.alt,className:n==null?void 0:n.image,style:{maxWidth:"100%",height:"auto",display:"block",margin:"1rem 0"}}):null}const M=(o,r={})=>{const n=c.useMemo(()=>{var e;return(e=o==null?void 0:o.body)!=null&&e.content?k(o.body.content):[]},[o]);return{html:c.useMemo(()=>{var e;return(e=o==null?void 0:o.body)!=null&&e.content?W(o.body.content,o.inlineObjects,o.lists,r):null},[o,r]),toc:n}};function W(o,r,n,t={}){const{renderers:e={},transformers:i=[],classNames:s={}}=t,d=v(o,i),p=(l,a,h)=>W(l,a,h,t);return d.map((l,a)=>{let h=null,g={};return"type"in l?l.type==="list_group"?(h=e.list_group||V,g={items:l.items,inlineObjects:r,lists:n,renderers:e,classNames:s}):l.type==="code_block"&&(h=e.code_block||q,g={block:l,classNames:s}):l.paragraph?(h=e.paragraph||Q,g={paragraph:l.paragraph,inlineObjects:r,renderers:e,classNames:s}):l.table&&(h=e.table||Y,g={table:l.table,inlineObjects:r,lists:n,renderContent:p,classNames:s}),h?c.createElement(z,{key:a},c.createElement(h,{...g})):null})}const J=({doc:o,className:r,renderers:n,transformers:t})=>{const{html:e,toc:i}=M(o,{renderers:n,transformers:t});return o?c.createElement("div",{className:r},c.createElement("div",{className:"gdoc-content"},e),i.length>0&&c.createElement("nav",{className:"gdoc-toc"},c.createElement("ul",null,i.map(s=>c.createElement("li",{key:s.id,className:`gdoc-toc-level-${s.level}`},c.createElement("a",{href:`#${s.id}`},s.text)))))):null},Z=({doc:o,className:r,renderers:n,transformers:t})=>{const{html:e}=M(o,{renderers:n,transformers:t});return o?c.createElement("div",{className:r},e):null};f.GDocContent=Z,f.GDocScribe=U,f.GDocViewer=J,f.buildListTree=D,f.extractHeadings=k,f.getAlignmentStyle=B,f.getColorStyle=G,f.getDimensionStyle=y,f.getHeadingTag=j,f.getImageData=F,f.getListTagAndStyle=O,f.getParagraphText=L,f.getTextTags=A,f.parseInlineContent=w,f.processContent=v,f.slugify=C,f.useDocs=M,Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});
